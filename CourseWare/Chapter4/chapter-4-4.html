<!DOCTYPE HTML>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>计算机图形学-几何与变换</title>
    <meta name="description" content="WebGL几何形体与变换基础">
    <meta name="author" content="Liyi">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="stylesheet" href="../dist/reset.css">
    <link rel="stylesheet" href="../dist/reveal.css">
    <link rel="stylesheet" href="../dist/theme/mywhite.css" id="theme">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="../plugin/highlight/monokai.css" id="highligh">

    <style type="text/css">
        .columnleft {
            float: left;
            width: 50%;
        }

        .columnright {
            float: right;
            width: 50%;
        }
    </style>
</head>
    
<body>
    <div class="reveal">
        <div class="slides">
            <section id="titlepage">
                <h1>计算机图形学</h1>
                <H2>第四章 几何和变换</H2>
                <h3>变换</h3>
                
                <p id="date"></p>
                <script>
                    var now = new Date();
                    var year = now.getFullYear();
                    var month = now.getMonth();
                    var day = now.getDate();
                    document.getElementById("date").innerHTML = year + "年" + (1 + month) + "月" + day + "日";
                </script>
            </section>
            <section id="gentrans">
                <h2>变换</h2>
                <h3>一般变换</h3>
                <p style="text-align:left">变换，指的是建立点与点之间，或向量与向量之间的映射。如下图中所示，有映射关系$v=T(u)$, $Q=T(P)$</p>
                <img src="../images/ch04-generaltrans.png" style="width:70%">
            </section>
            <section>
                <section id="afftrans">
                    <h2>变换</h2>
                    <h3>仿射变换</h3>
                    <p style="text-align:left">仿射变换，能够维持线性属性，其中包含了物理上重要的变换，如<strong>刚体变换(Rigid-body transformation)：旋转(Rotation)、平移(Translation)</strong>，以及非刚性变换(Non-rigid body transformation)，如<strong>缩放(Scaling)、错切(Shear)</strong>变换</p>
                    <p style="text-align:left">在图形学中，仿射变换是非常重要的，这是因为绘制线段时，可以通过变换线段的顶点，然后通过连接顶点绘制相应变换后的线段</p>
                </section>
                <section id="pipimp">
                    <h2>变换</h2>
                    <h3>仿射变换流水线实现</h3>
                    <img src="../images/ch04-afftransimple.png" style="width:100%">
                </section>
            </section>
            <section>
                <section id="trans">
                    <h2>变换</h2>
                    <h3>平移</h3>
                    <p style="text-align:left">平移，即将点从一个位置$P$移动到一个新的位置$P'$，位移向量为$d$</p>
                    <p style="text-align:left">平移具有三个自由度，用公式可表示为$P'=P+d$</p>
                    <img src="../images/ch04-translateillu.png" style="width:90%">
                </section>
                <section id="transhomo">
                    <h2>变换</h2>
                    <h3>平移的齐次坐标表示</h3>
                    <p style="text-align:left">用齐次坐标分别表示点和向量，有
                    $$
                    \begin{aligned}
                    P=\begin{bmatrix}x & y & z & 1\end{bmatrix}^T\\
                    P'=\begin{bmatrix}x' & y' & z' & 1\end{bmatrix}^T\\
                    d=\begin{bmatrix}d_x & d_y & d_z & 0\end{bmatrix}^T
                    \end{aligned}$$
                
                    则有$P'=P+d$，即
                    $$x'=x+d_x, y'=y+d_y, z'=z+d_z$$</p>

                </section>
                <section id="transmat">
                    <h2>变换</h2>
                    <h3>平移的矩阵实现</h3>
                    <p style="text-align:left">若用矩阵表示平移变换，有$p=TP$，其中，$T$定义为变换矩阵，有
                    $$
                    T=T(d_x,d_y,d_z)=\begin{bmatrix}
                    1 & 0 & 0 & d_x\\
                    0 & 1 & 0 & d_y\\
                    0 & 0 & 1 & d_z\\
                    0 & 0 & 0 & 1\\
                    \end{bmatrix}$$</p>
                </section>
            </section>
            <section>
                <section id="rotin2d">
                    <h2>变换</h2>
                    <h3>旋转(2D)</h3>
                    <p style="text-align:left">在二维平面的旋转，考虑绕原点逆时针旋转$\theta$角度</p>
                    <div class="columnleft">
                        <img src="../images/ch04-rot2dillu.png">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left font-size:50%">
                        $$\begin{cases}
                        x'=r\cos(\phi+\theta)\\
                        y'=r\sin(\phi+\theta)
                        \end{cases}$$
                        
                        $$\begin{cases}
                        x=r\cos(\phi)\\
                        y=r\sin(\phi)
                        \end{cases}
                        
                        可得
                        $$\begin{cases}
                        x'=x\cos(\theta)-y\sin(\theta)\\
                        y'=x\sin(\theta)+y\cos(\theta)\\
                        \end{cases}</p>
                    </div>
                </section>
                <section id="rotz">
                    <h2>变换</h2>
                    <h3>绕Z轴旋转</h3>
                    <p style="text-align:left">在三维空间绕$Z$轴旋转，保持点的$Z$坐标保持不变</p>
                    <img src="../images/ch04-rotzview.png" style="width:70%">
                </section>
                <section id="homrotz">
                    <h2>变换</h2>
                    <h3>绕Z轴旋转齐次坐标矩阵表示</h3>
                    
                        <p style="text-align:left;font-size:80%">在三维空间绕Z轴旋转可视作在XOY平面绕原点旋转在三维空间的扩展，有
                        $$
                        \begin{cases}
                        x'=x\cos{\theta}-y\sin{\theta}\\
                        y'=x\sin{\theta}+ysin{\theta}\\
                        z'=z
                        \end{cases}
                        $$
                        </p>
                    
                        <p style="text-align:left;font-size:80%">将前式写成齐次坐标矩阵形式有$P'=R_Z(\theta)P$，其中，矩阵$R_Z(\theta)$定义为
                        $$
                        R=R_Z(\theta)=\begin{bmatrix}
                        \cos{\theta} & -\sin{\theta} & 0 & 0\\
                        \sin{\theta} & \cos{\theta} & 0 & 0\\
                        0 & 0 & 1 & 0\\
                        0 & 0 & 0 & 1
                        \end{bmatrix}
                        $$
                        </p>
                </section>
                <section id="rotxy">
                    <h2>变换</h2>
                    <h3>绕X轴和Y轴旋转</h3>
                    <div style="position:absolute;left:0px">
                        <table class="image" style="border:0;">
                            <caption align="bottom"><small>绕X轴正向旋转$\theta$角度</small></caption>
                            <tr>
                                <td><img src="../images/ch04-rotxview.png" style="height:400px;border:0"></td>
                            </tr>
                        </table>
                    </div>
                    <div style="position:absolute;right:0px">
                        <table class="image" style="border:0;">
                            <caption align="bottom"><small>绕Y轴正向旋转$\theta$角度</small></caption>
                            <tr>
                                <td><img src="../images/ch04-rotyview.png" style="height:400px;border:0"></td>
                            </tr>
                        </table>
                    </div>
                </section>
                <section id="homorotxy">
                    <h2>变换</h2>
                    <h3>绕X和Y轴旋转齐次坐标矩阵表示</h3>
                    <p style="text-align:left;font-size:80%">利用与$Z$轴相同的方式，可推导得到绕$X$轴和$Y$轴旋转的齐次坐标矩阵表示
                    $$
                        R=R_X(\theta)=\begin{bmatrix}
                        1&0&0&0\\
                        0&\cos{\theta}&-\sin{\theta}&0\\
                        0&\sin{\theta}&\cos{\theta}&0\\
                        0&0&0&1
                        \end{bmatrix}
                    $$
                    $$
                        R=R_Y(\theta)=\begin{bmatrix}
                        \cos{\theta}&0&\sin{\theta}&0\\
                        0&1&0&0\\
                        -\sin{\theta}&0&\cos{\theta}&0\\
                        0&0&0&1
                        \end{bmatrix}
                     $$
                    </p>
                </section>
                <section id="querot">
                    <h2>变换</h2>
                    <h3>绕任意点的旋转</h3>
                    <img src="../images/ch04-anyrot.png" style="width:100%">
                    <p steyl="text-align:left">思考，如何实现绕任意点的旋转？</p>
                </section>
            </section>
            <section>
                <section id="scale">
                    <h2>变换</h2>
                    <h3>缩放</h3>
                    <p style="text-align:left">缩放，即沿着某一轴方向改变物体的大小</p>
                    <div class="columnleft">
                    <p style="text-align:left;font-size:80%">其表达式可写成
                    $$\begin{cases}
                    x'=s_xx\\
                    y'=s_yy\\
                    z'=s_zz
                    \end{cases}$$
                
                    即$p'=Sp$, 对应的齐次坐标矩阵$S$表示为
                    $$
                    S=S(s_x,s_y,s_z)
                    =\begin{bmatrix}
                    s_x&0&0&0\\
                    0&s_y&0&0\\
                    0&0&s_z&0\\
                    0&0&0&1
                    \end{bmatrix}
                    $$</p>
                    </div>
                    <div class="columnright">
                        <img src="../images/ch04-scaling.png" style="width:100%">
                    </div>
                </section>
                <section id="reflec">
                    <h2>变换</h2>
                    <h3>反射</h3>
                    <div class="columnleft">
                        <p style="text-align:left;font-size:80%">
                        反射，可视作缩放的特殊形式，有
                        $$
                        \begin{cases}
                        s_x=1, s_y=1\\
                        s_x=-1, s_y=1\\
                        s_x=-1, s_y=-1\\
                        s_x=1, s_y=-1
                        \end{cases}
                        $$</p>
                    </div>
                    <div class="columnright">
                        <img src="../images/ch04-reflection.png" style="width:100%">
                    </div>
                </section>
                <section id="shear">
                    <h2>变换</h2>
                    <h3>错切</h3>
                    <p style="text-align:left">错切，相当于沿着相反方向拉动对象的表面</p>
                    <div class="columnleft">
                        <p style="text-align:left; font-size:xx-large">
                        $$\begin{cases}
                        x'=x+y\cos{\theta}\\
                        y'=y\\
                        z'=z
                        \end{cases}$$
                        <br>
                        对应矩阵为
                        $$
                        H=H(\theta)=
                        \begin{bmatrix}
                        1&\cot{\theta}&0&0\\
                        0&1&0&0\\
                        0&0&1&0\\
                        0&0&0&1
                        \end{bmatrix}
                        $$
                        </p>
                    </div>
                    <div class="columnright">
                        <img src="../images/ch04-shear.png"><br>
                        <img src="../images/ch04-shear-comp.png" style="width:80%">
                    </div>
                </section>
            </section>
            <section>
                <section id="invtrans">
                    <h2>变换</h2>
                    <h3>逆变换</h3>
                    <p style="text-align:left">对三种基本变换、平移、旋转和缩放，都有对应的逆变换：</p>
                    <ul>
                        <li style="text-align:left">平移: $T^{-1}(d_x,d_y,d_z)=T(-d_x,-d_y,-d_z)$</li>
                        <li style="text-align:left">旋转: $R^{-1}(\theta)=R(-\theta)=R^{T}(\theta)$</li>
                        <li style="text-align:left">缩放: $S^{-1}(s_x,s_y,s_z)=S(1/s_x,1/s_y,1/s_z)$</li>
                    </ul>
                </section>
                <section id="concat">
                    <h2>变换</h2>
                    <h3>变换的连接</h3>
                    <p style="text-align:left">
                    任意仿射变换都可通过连接平移、旋转、缩放操作完成，结果对应于这些矩阵相乘的结果</p>
                    <p style="text-align:left">计算矩阵$M=ABCD$，再将矩阵$M$应用于所有的顶点有$P'=MP$，此处$P$为<strong style="color:red">顶点列向量</strong></p>
                    <p style="Text-align:left">难点在于<strong style="color:red">如何通过变换组合实现预期的变换结果</strong></p>
                </section>
                <section id="order">
                    <h2>变换</h2>
                    <h3>变换的顺序</h3>
                    <p style="text-align:left">变换结果矩阵$M=ABCD$，$$p'=Mp=ABCp=(A(B(Cp)))$$ 相应有$$p'^T=p^TC^TB^TA^T$$</p>
                </section>
                <section id="rotorig">
                    <h2>变换</h2>
                    <h3>绕原点的任意转动</h3>
                    <p style="text-align:left; font-size:80%">绕任意轴转动$\theta$角度，均可分解为绕X,Y,Z三条轴的转动复合连接，有
                    $$R(\theta)=R_z(\theta_z)R_y(\theta_y)R_x(\theta_x)$$ 其中，$\theta_x,\theta_y,\theta_z$称为欧拉角，注意这里顺序不可改变，若改变顺序，角度值会发生变化</p>
                    <img src="../images/ch04-anyaxisrot.png">
                </section>
                <section id="instance">
                    <h2>变换</h2>
                    <h3>实例化</h3>
                    <p style="text-align:left">物体建模时，一靓会将物体的中心设置为坐标系的原点，物体方向与坐标轴方向保持一致，并且将对象大小设置为单位大小</p>
                    <p style="text-align:left">如需要将物体放置到某个世界中，一般需要经过缩放、调整方向和位置等操作，也就是各种变换的组合</p>
                </section>
            </section>
            <section>
                <section id="comptrans">
                    <h2>变换</h2>
                    <h3>实现在二维平面绕物体对象中心的旋转</h3>
                    <img src="../images/ch04-anyrot.png" style="width:100%">
                </section>
                <section id="decomptrans">
                    <h2>变换</h2>
                    <h3>复合变换解析</h3>
                    <div class="columnleft" style="width:25%">
                        <img src="../images/ch04-mrotstart.png">
                        <br>
                        <figurecaption style="font-size:80%">$M=I$</figurecaption>
                    </div>
                    <div class="columnleft" style="width:25%">
                        <img src="../images/ch04-mrot1.png">
                        <br>
                        <figurecaption style="font-size:80%">$M_1=T(-p_c)$</figurecaption>
                    </div>
                    <div class="columnleft" style="width:25%">
                        <img src="../images/ch04-mrot2.png">
                        <br>
                        <figurecaption style="font-size:80%">$M_2=R(\theta)$</figurecaption>
                    </div>
                    <div class="columnright" style="width:25%">
                        <img src="../images/ch04-mrot3.png">
                        <br>
                        <figurecaption style="font-size:80%">$M_3=T(p_c)$</figurecaption>
                    </div>
                    <br>
                    <p style="text-align:left">$$M=M_3M_2M_1M=T(p_c)R(\theta)T(-p_c)$$</p>
                </section>
                <section id="matsol">
                    <h2>变换</h2>
                    <h3>绕任意点旋转后物体的新坐标</h3>
                    <p style="text-align:left">有点$p(x,y)$绕固定点$(c_x,c_y)$逆时针旋转$\theta$角度，计算旋转后点的新坐标$p'(x',y')$</p>
                    <div class="columnleft" style="width:33.3%">
                        <p style="text-align:left;font-size:x-large">将旋转中心平移到原点</p>
                        <p style="text-align:left;font-size:55%">
                        
                        $$
                        M_1=\begin{bmatrix}
                        1&0&-c_x\\
                        0&1&-c_y\\
                        0&0&1
                        \end{bmatrix}
                        $$</p>
                    </div>
                    <div class="columnleft" style="width:33.3%">
                        <p style="text-align:left;font-size:x-large">逆时针旋转$\theta$角度</p>
                        <p style="text-align:left;font-size:55%">
                        
                        $$
                        M_2=\begin{bmatrix}
                        \cos{\theta}&-\sin{\theta}&0\\
                        \sin{\theta}&\cos{\theta}&0\\
                        0&0&1
                        \end{bmatrix}
                        $$</p>
                    </div>
                    <div class="columnleft" style="width:33.3%">
                        <p style="text-align:left;font-size:x-large">将旋转中心平移到原点</p>
                        <p style="text-align:left;font-size:55%">
                            $$
                            M_3=\begin{bmatrix}
                            1&0&c_x\\
                            0&1&c_y\\
                            0&0&1
                            \end{bmatrix}
                            $$</p>
                    </div>

                    <p style="text-align:left;font-size:xx-large">$p'=Mp=M_3M_2M_1p$
                    $$
                    M=\begin{bmatrix}
                    1&0&-c_x\\
                    0&1&-c_y\\
                    0&0&1
                    \end{bmatrix}
                    \begin{bmatrix}
                    \cos{\theta}&-\sin{\theta}&0\\
                    \sin{\theta}&\cos{\theta}&0\\
                    0&0&1
                    \end{bmatrix}
                    \begin{bmatrix}
                    1&0&c_x\\
                    0&1&c_y\\
                    0&0&1
                    \end{bmatrix}
                    $$</p>
                </section>
                <section id="transorder">
                    <h2>变换</h2>
                    <h3>变换的顺序</h3>
                    <p style="text-align:center">绕原点旋转60度，沿X轴正向移动200单位</p>
                    <canvas id="dispcanvas" style="border:none;" width="500" height="500"></canvas>
                    <script>
                        var canvasd = document.getElementById("dispcanvas");
                        var ctxd = canvasd.getContext("2d");
                        
                        var phase_1 = 1;
                        var phase_2 = 1;
                        var p1_cnt_1 = 0;//rt
                        var p2_cnt_1 = 0;//ta
                        var p1_cnt_2 = 0;//rt
                        var p2_cnt_2 = 0;//ta
                        var p1 = 60;
                        var p2 = 200;

                        window.requestAnimFrame = (function (callback) {
                            return window.requestAnimationFrame ||
                                window.webketRequestAnimationFrame ||
                                window.mozRequestAnimationFrame ||
                                window.oRequestAnimationFrame ||
                                window.msRequestAnimationFrame ||
                                function (callback) {
                                    window.setTimeout(callback, 1000 / 60);
                                };
                        })();

                        function drawSquare(myRectangle, context) {
                            context.beginPath();
                            context.rect(myRectangle.x, myRectangle.y, myRectangle.width, myRectangle.height);
                            context.fillStyle = "#CD83C0";
                            context.fill();
                            context.lineWidth = myRectangle.borderWidth;
                            context.strokeStyle = 'black';
                            context.stroke();
                        }

                        function drawAxis(canvas, context) {
                            context.setTransform();
                            context.beginPath();
                            context.lineWidth = 3;
                            context.strokeStyle = 'black';
                            context.moveTo(0, canvas.height / 2);
                            context.lineTo(canvas.width, canvas.height / 2);
                            context.stroke();
                            context.moveTo(canvas.width, canvas.height / 2);
                            context.lineTo(canvas.width - 20, canvas.height / 2 - 10);
                            context.stroke();
                            context.moveTo(canvas.width, canvas.height / 2);
                            context.lineTo(canvas.width - 20, canvas.height / 2 + 10);
                            context.stroke();
                            context.moveTo(canvas.width / 2, canvas.height);
                            context.lineTo(canvas.width / 2, 0);
                            context.stroke();
                            context.moveTo(canvas.width / 2, 0);
                            context.lineTo(canvas.width / 2 - 10, 20);
                            context.stroke();
                            context.moveTo(canvas.width / 2, 0);
                            context.lineTo(canvas.width / 2 + 10, 20);
                            context.stroke();
                        }
                        function animate(lastTime, myRectangle, runAnimation, canvas, context) {
                            // 先转后移
                            if (runAnimation.value) {

                                context.setTransform();
                                context.clearRect(0, 0, canvas.width, canvas.height);

                                var time = (new Date()).getTime();
                                var timeDiff = time - lastTime;

                                context.translate(canvas.width / 2, canvas.height / 2);

                                context.translate(p2_cnt_1, 0);
                                context.rotate(-p1_cnt_1 * Math.PI / 180.0);

                                //context.translate( p2_cnt, 0  );


                                if (phase_1 == 1 && p1_cnt_1 <= p1) {
                                    p1_cnt_1 = p1_cnt_1 + 1;
                                    if (p1_cnt_1 > p1)
                                        phase_1 = 2;
                                }

                                if (phase_1 == 2 && p2_cnt_1 <= p2) {
                                    p2_cnt_1 = p2_cnt_1 + 1;
                                    if (p2_cnt_1 > p2)
                                        phase_1 = 1;
                                }


                                drawSquare(myRectangle, context);
                                drawAxis(canvas, context);

                                requestAnimFrame(function () {
                                    animate(time, myRectangle, runAnimation, canvas, context);
                                });
                            }
                        }
                        function animate2(lastTime, myRectangle, runAnimation, canvas, context) {
                            // 先移后转
                            if (runAnimation.value) {

                                context.setTransform();
                                context.clearRect(0, 0, canvas.width, canvas.height);

                                var time = (new Date()).getTime();
                                var timeDiff = time - lastTime;

                                context.translate(canvas.width / 2, canvas.height / 2);

                                context.rotate(-p1_cnt_2 * Math.PI / 180.0);
                                context.translate(p2_cnt_2, 0);

                                //context.translate( p2_cnt, 0  );

                                if (phase_2 == 2 && p1_cnt_2 <= p1) {
                                    p1_cnt_2 = p1_cnt_2 + 1;
                                    if (p1_cnt_2 > p1)
                                        phase_2 = 1;
                                }

                                if (phase_2 == 1 && p2_cnt_2 <= p2) {
                                    p2_cnt_2 = p2_cnt_2 + 1;
                                    if (p2_cnt_2 > p2)
                                        phase_2 = 2;
                                }

                                drawSquare(myRectangle, context);
                                drawAxis(canvas, context);

                                requestAnimFrame(function () {
                                    animate2(time, myRectangle, runAnimation, canvas, context);
                                });
                            }
                        }

                        var myRectangle = {
                            x: -50,
                            y: -25,
                            width: 100,
                            height: 50,
                            borderWidth: 5
                        };

                        var runAnimation = {
                            value: false
                        }
                        
                        ctxd.translate(canvasd.width / 2, canvasd.height / 2);
                        drawSquare(myRectangle, ctxd);
                        drawAxis(canvasd, ctxd);
                    </script>
                </section>
                <section id="rottrans">
                    <h2>变换</h2>
                    <h3>变换的顺序</h3>
                    <p style="text-align:center">先绕原点旋转60度，再沿X轴正向移动200单位</p>
                    <canvas id="rtcanvas" style="border:none;" width="500" height="500"></canvas>
                    <script>
                        var canvas1 = document.getElementById("rtcanvas");
                        var ctx1 = canvas1.getContext("2d");
                        document.getElementById('rtcanvas').addEventListener('click', function () {
                                if (!runAnimation.value){
                                    runAnimation.value = !runAnimation.value;
                                    phase_2 = 1;
                                    p1_cnt_2 = 0;//rt
                                    p2_cnt_2 = 0;//ta
                                }
                                 
                                if (runAnimation.value) {
                                    var date = new Date();
                                    var time = date.getTime();
                                    animate(time, myRectangle, runAnimation, canvas1, ctx1);
                                }
                            });
                        ctx1.translate(canvas1.width / 2, canvas1.height / 2);
                        drawSquare(myRectangle, ctx1);
                        drawAxis(canvas1, ctx1);
                    </script>
                </section>
                <section id="transrot">
                    <h2>变换</h2>
                    <h3>变换的顺序</h3>
                    <p style="text-align:center">先沿X轴正向移动200单位，再绕原点旋转60度</p>
                    <canvas id="trcanvas" style="border:none;" width="500" height="500"></canvas>
                    <script>
                        var canvas2 = document.getElementById("trcanvas");
                        var ctx2 = canvas2.getContext("2d");
                        
                        document.getElementById('trcanvas').addEventListener('click', function () {
                                if (!runAnimation.value){
                                    runAnimation.value = !runAnimation.value;
                                    phase_2 = 1;
                                    p1_cnt_2 = 0;//rt
                                    p2_cnt_2 = 0;//ta
                                }
                                    
                                if (runAnimation.value) {
                                    var date = new Date();
                                    var time = date.getTime();
                                    animate2(time, myRectangle, runAnimation, canvas2, ctx2);
                                }
                            });
                        ctx2.translate(canvas2.width / 2, canvas2.height / 2);
                        drawSquare(myRectangle, ctx2);
                        drawAxis(canvas2, ctx2);
                    </script>
                </section>
            </section>
            <section>
                <section id="mtrans">
                    <h2>变换</h2>
                    <h3>三维复合变换举例</h3>
                    <div class="columnleft">
                        <img src="../images/ch04-rot3danyaxis.png" style="width:80%">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left;font-size:xx-large">
                        已知$\overrightarrow{\mathbf{P_0P_1}}=\{x_1-x_0,y_1-y_0,z_1-z_0\}$,$\overrightarrow{n}=(\cos{\alpha}, \cos{\beta}, \cos{\gamma})$, 求空间一点$P(x,y,z)$绕$\overrightarrow{\mathbf{P_0P_1}}$逆时针旋转$\theta$角度时的变换矩阵</p>
                    </div>
                </section>
                <section id="mtrans-so1">
                    <h2>变换</h2>
                    <h3>三维复合变换举例-步骤1</h3>
                    <div class="columnleft">
                        <img src="../images/ch04-rot3danyaxiss1.png" style="width:80%">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left;font-size:xx-large">
                            将$\mathbf{P_0}$移到原点, 即有
                            $$
                            \mathbf{M_1}=
                            \begin{bmatrix}
                            1&0&0&-x_0\\
                            0&1&0&-y_0\\
                            0&0&1&-z_0\\
                            0&0&0&1
                            \end{bmatrix}
                            $$
                        </p>
                    </div>
                </section>
                <section id="mtrans-so2">
                    <h2>变换</h2>
                    <h3>三维复合变换举例-步骤2</h3>
                    <div class="columnleft">
                        <img src="../images/ch04-rot3danyaxiss2.png" style="width:80%">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left;font-size:xx-large">
                            将$\mathbf{P_0P_1}$绕$y$轴顺时针旋转$\theta_y$角度，使之与平面$yOz$重合
                            $$
                            \mathbf{M_2}=
                            \begin{bmatrix}
                            \cos{\theta_y}&0&-\sin{\theta_y}&0\\
                            0&1&0&0\\
                            \sin{\theta_y}&0&\cos{\theta_y}&0\\
                            0&0&0&1
                            \end{bmatrix}
                            $$
                        </p>
                    </div>
                </section>
                <section id="mtrans-so3">
                    <h2>变换</h2>
                    <h3>三维复合变换举例-步骤3</h3>
                    <div class="columnleft">
                        <img src="../images/ch04-rot3danyaxiss3.png" style="width:80%">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left;font-size:xx-large">
                            将$\mathbf{P_0P_1}$绕$x$轴逆时针旋转$\theta_x$角度，使之与$z$轴重合
                            $$
                            \mathbf{M_3}=
                            \begin{bmatrix}
                            1&0&0&0\\
                            0&\cos{\theta_x}&-\sin{\theta_x}&0\\
                            0&\sin{\theta_x}&\cos{\theta_x}&0\\
                            0&0&0&1
                            \end{bmatrix}
                            $$
                        </p>
                    </div>
                </section>
                <section id="mtrans-so4">
                    <h2>变换</h2>
                    <h3>三维复合变换举例-步骤4</h3>
                    <div class="columnleft">
                        <img src="../images/ch04-rot3danyaxiss4.png" style="width:80%">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left;font-size:xx-large">
                            将$\mathbf{P}$绕$z$轴逆时针旋转$\theta$角度
                            $$
                            \mathbf{M_4}=
                            \begin{bmatrix}
                            \cos{\theta}&-\sin{\theta}&0&0\\
                            \sin{\theta}&\cos{\theta}&0&0\\
                            0&0&1&0\\
                            0&0&0&1
                            \end{bmatrix}
                            $$
                        </p>
                    </div>
                </section>
                <section id="3dmultran5">
                    <h2>变换</h2>
                    <h3>三维复合变换举例-步骤5</h3>
                    <div class="columnleft">
                        <img src="../images/ch04-rot3danyaxiss5.png" style="width:80%">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left;font-size:xx-large">
                            将$\mathbf{P_0P_1}$绕$x$轴顺时针旋转$\theta_x$角度
                            $$
                            \mathbf{M_5}=
                            \begin{bmatrix}
                            1&0&0&0\\
                            0&\cos{\theta_x}&-\sin{\theta_x}&0\\
                            0&\sin{\theta_x}&\cos{\theta_x}&0\\
                            0&0&0&1
                            \end{bmatrix}
                            $$
                        </p>
                    </div>
                </section>
                <section id="3dmultran6">
                    <h2>变换</h2>
                    <h3>三维复合变换举例-步骤6</h3>
                    <div class="columnleft">
                        <img src="../images/ch04-rot3danyaxiss6.png" style="width:80%">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left;font-size:xx-large">
                            将$\mathbf{P_0P_1}$绕$y$轴逆时针旋转$\theta_y$角度
                            $$
                            \mathbf{M_6}=
                            \begin{bmatrix}
                            \cos{\theta_y}&0&\sin{\theta_y}&0\\
                            0&1&0&0\\
                            -\sin{\theta_y}&0&\cos{\theta_y}&0\\
                            0&0&0&1
                            \end{bmatrix}
                            $$
                        </p>
                    </div>
                </section>
                <section id="3dmultran7">
                    <h2>变换</h2>
                    <h3>三维复合变换举例-步骤7</h3>
                    <div class="columnleft">
                        <img src="../images/ch04-rot3danyaxiss7.png" style="width:80%">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left;font-size:xx-large">
                            将$\mathbf{P_0}$移回原位置
                            $$
                            \mathbf{M_7}=
                            \begin{bmatrix}
                            1&0&0&x_0\\
                            0&1&0&y_0\\
                            0&0&1&z_0\\
                            0&0&0&1
                            \end{bmatrix}
                            $$
                            <br>
                            因此，变换矩阵$\mathbf{M=M_7M_6M_5M_4M_3M_2M_1}$, 并有$\mathbf{P'=MP}$, 那么，$\mathbf{M}$中所涉及的$\cos{\theta_x},\sin{\theta_x}, \cos{\theta_y}, \sin{\theta_y}$等该如何求解呢?
                        </p>
                    </div>
                </section>
                <section id="3dmultran8">
                    <h2>变换</h2>
                    <h3>三维复合变换举例-步骤8</h3>
                    <p style="text-align:left;font-size:x-large">
                        取$z$轴上一单位矢量$k$，将其绕$x$轴顺时针转动$\theta_x$角度，后再绕$y$轴逆时针旋转$\theta_y$角度，使之与$\overrightarrow{\mathbf{P_0P_1}}$重合，有
                        
                            $$
                            \begin{bmatrix}
                            x'\\
                            y'\\
                            z'\\
                            1
                            \end{bmatrix}
                            =\begin{bmatrix}
                            \cos{\theta_y}&0&\sin{\theta_y}&0\\
                            0&1&0&0\\
                            -\sin{\theta_y}&0&\cos{\theta_y}&0\\
                            0&0&0&1
                            \end{bmatrix}
                            \begin{bmatrix}
                            1&0&0&0\\
                            0&\cos{\theta_x}&\sin{\theta_x}&0\\
                            0&-\sin{\theta_x}&\cos{\theta_x}&0\\
                            0&0&0&1\\
                            \end{bmatrix}
                            \begin{bmatrix}
                            0\\
                            0\\
                            1\\
                            1
                            \end{bmatrix}
                            $$
                    </p>
                    <div class="columnleft">
                        <img src="../images/ch04-rot3danyaxiss8.png" style="width:80%">
                    </div>
                    <div class="columnright">
                        <p style="text-align:left;font-size:x-large">
                            $$
                            \begin{cases}
                            x'=\cos{\theta_x}\sin{\theta_y}=\cos{\alpha}\\
                            y'=\sin{\theta_x}=\cos{\beta}\\
                            z'=\cos{\theta_x}\cos{\theta_y}=\cos{\gamma}\\
                            \end{cases}
                            $$
                            $$
                            \begin{cases}
                            \sin{\theta_x}=\cos{\beta}\\
                            \cos{\theta_x}=\sqrt{1-\cos^2{\beta}}=\sqrt{\cos^2{\alpha}+\cos^2{\gamma}}\\
                            \sin{\theta_y}=\frac{\cos{\alpha}}{\cos{\theta_x}}=\frac{\cos{\alpha}}{\sqrt{\cos^2{\alpha}+\cos^2{\gamma}}}\\
                            \cos{\theta_y}=\frac{\cos{\gamma}}{\cos{\theta_x}}=\frac{\cos{\gamma}}{\sqrt{\cos^2{\alpha}+\cos^2{\gamma}}}
                            \end{cases}
                            $$
                        </p>
                    </div>
                </section>
            </section>
        </div>
    </div>

    <script src="../dist/reveal.js"></script>
    <script src="../plugin/zoom/zoom.js"></script>
    <script src="../plugin/notes/notes.js"></script>
    <script src="../plugin/math/math.js"></script>
    <script src="../plugin/search/search.js"></script>
    <script src="../plugin/markdown/markdown.js"></script>
    <script src="../plugin/highlight/highlight.js"></script>
    <script>
        Reveal.initialize({
            // display controls in the bottom right corner
            controls: true,

            // display a presentation progress bar
            progress: true,

            // set default timing of 2 minutes per slides
            defaultTiming: 120,

            // Display the page number of the current slides
            slideNumber: true,

            // Push each slide change to the browser history
            history: false,

            // Enable keyboard shortcuts for navigation
            keyboard: true,

            // Enable the slide overview mode
            overview: true,

            // Vertical centering of slides
            center: true,

            // Enable touch navigation on devices with touch input
            touch: true,

            // Loop the presentation
            loop: false,

            // Change teh presentation direction to be RTL
            rtl: false,

            // Randomizes the order of slides each time the presentation loads
            shuffle: false,

            // Turns fragments on and off globally
            fragment: true,

            // Flags if the presentation is running in an embedded mode,
            // i.e. contained within a limited portion of the screen
            embedded: false,

            // Flags if we should show a help overlay when the questionmark key is pressed
            help: true,

            // Flags if speaker notes should be visible to all viewers
            showNotes: false,

            // Global override for autoplaying embedded media( video/audio/iframe)
            // - null: media will only autoplay if data-autopay is present
            // - true: all media will autoplay, regradless of individual setting
            // - false: no media will autoplay, regardless of individual setting
            autoPlayMedia: null,

            // Number of milliseconds between automatically proceeding to the next slide, 
            //disabled when set to 0, this value can be overwritten by
            // using a data-autoslide attribute on your slides
            autoSlide: 0,

            // Stop auto-sliding after user input
            autoSlideStoppable: true,

            // Use this method for navigation when auto-sliding
            autoSlideMethod: Reveal.navigateNext,

            // Enable slide navigation via mouse wheel
            mouseWheel: false,

            // Hides the address bar on mobile devices
            hideAddressBar: true,

            // Opens links in an iframe preview overlay
            previewLinks: false,

            // Transition style
            transition: 'slide', // none/fade/slide/convex/concave/zoom

            // Transition speed
            transitionSpeed: 'default', // default/fast/slow

            // Transition style for full page slide backgrounds
            backgroundTransition: 'fade', // none/fade/slide/convex/concave/zoom

            // Number of slides away from the current that are visible
            viewDistance: 3,

            // Parallax background image
            parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakin-static/reveal-js/reveal-parallax-1.jpg'"

            // Parallax background size
            parallaxBackgroundSize: '', // CSS syntax, e.g. "2100px 900px"

            // Number of pixels to move the parallax background per slide
            // - calculated automatically unless specified
            // - set to 0 to disable movement along an axis
            parallaxBackgroundHorizontal: null,
            parallaxBackgroundVertical: null,

            // The display mode that will be used to show slides
            display: 'block',

            // print to pdf while no slide grows to more than one printed page
            pdfMaxPagesPerSlide: 1,

            // presentation
            width: 900,
            height: 900,

            margin: 0.1,

            minScale: 0.2,
            maxScale: 1.5,

            math: {
                mathjax: 'https://cdn.jsdelivr.net/gh/mathjax/mathjax@2.7.8/MathJax.js',
                config: 'TeX-AMS_HTML-full',
                // pass other options into `MathJax.Hub.Config()`
                TeX: { Macros: { RR: "{\\bf R}" } }
            },

            plugins: [RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight, RevealMath]
        });
    </script>
</body>

</html>